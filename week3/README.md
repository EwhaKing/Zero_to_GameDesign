# 3️⃣ week3: 데이터 테이블 다루기

### 📌내용
# 데이터 테이블

- 많은 데이터를 정리하고 관리하기 위한 테이블
- 특별히 정해진 형태는 없다.
- 예시
    
    ### 주인공 자신과 관련된 테이블
    
    - 캐릭터 테이블 : 캐릭터의 기초가 되는 테이블
      
    - 장비 테이블 : 장비관련 테이블들의 큰 틀로, 테이블들을 연결함
        - 하나의 테이블로 만들어도 괜찮으나 장비 강화 테이블, 스탯 관련 테이블로 나누게 되면 장비 테이블에서 이들을 연결함
          
    - 소모품 테이블 : 물약 등의 소모품 관리
      
    - 스킬 테이블
    
    - 스탯 테이블
        - 스탯 종류
        - 캐릭터 성장 시 스탯 변화량
        - 장비 관련 스탯
    
    - 레벨 테이블
        - 경험치 테이블
    
    ### 적과 관련된 테이블
    
    - 몬스터 테이블
    
    - 몬스터 스킬 테이블
    
    - 몬스터 사망 시 드랍 테이블
    
    - 몬스터 AI 테이블
        - 몬스터의 패턴 정보
        - 실제 기계학습 등이 들어가 있진 않고 특정 패턴에 따라 어떻게 스킬을 사용할 것인지에 대한 정보
    
    ### 스테이지 관련 테이블
    
    - 맵 테이블
        - 맵 이동시 좌표
        - **맵들의 성격 (사냥 필드, 마을, 던전 등)**
    
    - NPC 테이블
        - 기능이 없는 npc들 : 엑스트라로 상호작용이 딱히 없는 npc
        - 기능이 있는 npc들 : 퀘스트, 상점
    
    - 퀘스트 테이블
    
    - 콘텐츠 테이블
        - 컨텐츠를 클리어하기 위한 미션, 리워드 테이블, 퀘스트 완료 시 등급 테이블 등
        - 하나의 테이블로 만들 수 있고 각각의 콘텐츠 별로 만들 수도 있다
        - 컨텐츠에 따라 다양
    
    - 스테이지에 들어가나 테이블과 살짝 성격이 다른 것들
        - NPC 스포너, 몬스터 스포너, 이벤트 트리거
        - 테이블로 관리를 하기에는 좌표 정보를 적는 것이 효율적이지 않음
        - 맵 툴을 통해 작업하고 이곳에서 나온 데이터를 사용
        - 그냥 맵에다가 직접 배치하는 경우도 있음
    
    ### 아이템 테이블
    
    - 장비, 소모품, 잡템
    
    - **이것도 아이템 테이블**
        - 재화, 퀘스트 아이템, 이벤트 토큰, 유료 소모품, 유로 장비, 코스튬
****
## 테이블 만들기

위 아이템 테이블을 예시로 든다.

- **하나씩 테이블 만들기**
    - 위 아이템 테이블에서 쓰여진 요소들 각각을 테이블로 만들어 관리한다.

- **인접한 관계에 있는 것끼리 묶어 테이블을 만든다**
    - 장비 테이블(장비, 유료장비, 코스튬)
    - 소모품 테이블(소모품, 유료 소모품)
    - 아이템 테이블(퀘스트, 재화, 잡템, 토큰)

- **테이블 통으로 하나 만들기**

**→ 만드는 방식이 다양하고 정해진 것은 없다.**

### **테이블을 잘게 쪼갤 때의 장단점**

- 장점
    - 작업의 병목 현상이 생기지 않음
        - 1개의 테이블에 여러 명이 작업해서 발생하는 이슈가 생길 확률이 현저하게 줄어듦
        - 문제가 생겼을 때, 해당 테이블 하나만 되돌리면 됨
            - 크리티컬한 버그가 생기고 해결이 힘들다면 해당하는 테이블만 되돌리면 됨

- 단점
    - 데이터가 쌓일수록 다양한 테이블을 열어놓고 작업해야 함
        - 하나의 요소를 추가하기 위해 여러 개의 테이블을 열어놓고 작업해야 함
        - 연관된 요소가 많기에 테이블 하나로 끝나지 않는 경우가 많다

        - 예시
            
            - 스트링 테이블
                - 여러 나라에 서비스를 하기 위해 언어 테이블을 따로 빼놓음
                - 장비 이름과 같은 경우게 스트링 키를 장비 테이블에 입력하고 해당하는 스트링을 스트링 테이블에서 따로 관리
                - 관련해서 수정해야 한다면 장비 테이블과 스트링 테이블을 함께 켜두고 몬스터의 드랍템으로 만든다고 한다면 몬스터 관련 테이블도 켜두고 해당하는 스트링을 찾기 위해 역추적도 하고 이 글보다도 훨씬 복잡함
      
            - 밸런스 작업자
                - 밸런스를 잡기 위해 전체 테이블을 수정하는 경우가 생긴다.
                - 이때 무수하게 수정할 요소들이 무수하게 많은 테이블에 흩어져 있어 온갖 테이블들을 다 켜두고 수정하는 불상사가 일어날 수도

### 테이블에 들어갈 요소 예시

|칼럼명|설명|요소들|
|------|---|---|
|index|주소를 뜻한다.|아이템 테이블의 index|
|이름 (name)|아이템의 이름을 작성|글로벌 지원 시 string 테이블로 관리|
|설명(description)|실제 사용되는 것이 아니라 개발자가 확인하는 용도|개발자가 헷갈릴만한 요소를 간략하게 작성, 최소한의 방어 용도|
|아이템 종류 (itemType)|아이템 테이블 하나의 아이템 속성만 가지는 것이 아니므로 아이템의 속성을 구분하기 위한 종류 칼럼|equip: 장비, consume:재화, token : 토큰, quest : 퀘스트용 아이템 …|
|재화 타입(currencyType)|재화의 타입을 뜻함 재화의 key값을 정의하기 위한 요소|cash:현금, diamond: 유료재화 …|
|장비 부위 (parts)|장비의 경우 부위를 구분|weapon 무기, armor 방어구|
|장비 등급 (equipGrade)|장비의 등급 작성|normal, magic, rare…|
|아이콘 파일 (iconPath)|아이콘의 경로와 파일 이름 작성|~경로~|

### **Index**

- 여러가지 의미로 폭 넓게 활용

- mmorpg는 index가 구분되어 있다면 최적화 작업을 좀 더 효율적으로 할 수 있다.

- 세분화 되어 있고 규칙화 되어 있을 수록 추후 서버에서 다양한 업무를 할 때 빠르게 처리 가능

- 미리 정의가 잘 되어 있다면 검색이 용이함
    - 검색을 할 때 찾는 방식은 돌면서 걸러내고 또 돌면서 걸러내고가 반복되는 식인데 정의가 잘 되어 있다면 이 부분이 확 줄어듦
    - 데이터 작업자가 서버와 함께 정의한 값이 존재한다면 서버 안에서 작업을 하는 시간이 매우 즐어듦

- mmmorapg에서는 인덱스 규칙을 정해서 인덱스만 보고 어떤 아이템인지 알 수 있도록 하는 것도 좋다.
    - 규모가 커질 수록 인덱스를 여기저기 가져다 쓰기 때문
    - 근데 요즘에는 enum 값으로 작성하는 경우가 많아 예전만큼 index 확인을 많이 하진 않는다.`
